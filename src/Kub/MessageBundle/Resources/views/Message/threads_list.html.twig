<table>
	{% if threads %}
		{% for thread in threads %}
			<p class="apercu-message">
				<a href="{{ url('fos_message_thread_view', {'threadId': thread.id}) }}#message_{{ thread.lastMessage.id }}">
					<span>

						Le <strong>{{ thread.lastMessage.createdAt | date('d/m/y')}}</strong>, 

						{% if thread.lastMessage.sender.username == app.user.username %}
							
							vous avez dit

							 "<strong>
								{% if thread.lastMessage.body | length > 10 %}
									{{ thread.lastMessage.body | slice(0, 9) }}...
								{% else %}
									{{ thread.lastMessage.body }}
								{% endif %}
							</strong>" 

							Ã 

							{% for participant in thread.participants %}
								{% if participant.username != app.user.username %}
									<strong> {{ participant }} </strong>
								{% endif %}
							{% endfor %}

							.

						{% else %}
							
							<strong>{{ thread.lastMessage.sender }}</strong> vous a dit

							 "<strong>
								{% if thread.lastMessage.body | length > 10 %}
									{{ thread.lastMessage.body | slice(0, 9) }}...
								{% else %}
									{{ thread.lastMessage.body }}
								{% endif %}
							</strong>"

							. 

						{% endif %}

						{% if not fos_message_is_read(thread) %}
                            <span class="notifications new-message">Nouveau</span>
                        {% endif %}

						<span class="actions-messages">
							<span class="undelete-message">Afficher</span> 
							{% if fos_message_can_delete_thread(thread) %}
								ou
								{% if fos_message_deleted_by_participant(thread) %}
									{% set formAction %}{{ url('fos_message_thread_undelete', {'threadId': thread.id}) }}{% endset %}
									{% set submitValue %}Restaurer{% endset %}
									<form action="{{ formAction }}" method="post" class="hidden">
										<input type="submit" value="{{ submitValue }}" class="undelete-message"/>
									</form>
								{% else %}
									{% set formAction %}{{ url('fos_message_thread_delete', {'threadId': thread.id}) }}{% endset %}
									{% set submitValue %}Supprimer{% endset %}
									<form action="{{ formAction }}" method="post" class="hidden">
										<input type="submit" value="{{ submitValue }}" class="delete-message"/>
									</form>
								{% endif %}
							{% endif %}
						</span>
					</span>		
				</a>
			</p>
		{% endfor %}
	{% else %}
		<p>Aucun message</p>
	{% endif %}
