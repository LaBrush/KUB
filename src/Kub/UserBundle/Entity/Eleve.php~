<?php

namespace Kub\UserBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Validator\Constraints as Assert ;

/**
 * Eleve
 *
 * @ORM\Entity
 * @ORM\Table()
 *
 * @ORM\Entity(repositoryClass="Kub\UserBundle\Entity\EleveRepository")
 * @ORM\HasLifecycleCallbacks
 */
class Eleve extends User 
{
	/**
	 * @var integer
	 *
	 * @ORM\Column(name="id", type="integer")
	 * @ORM\Id
	 * @ORM\GeneratedValue(strategy="AUTO")
	 */
	protected $id;

	/**
	 * @var \DateTime
	 *
	 * @ORM\Column(name="anniversaire", type="date")
	 *
	 * @Assert\Date()
	 * @Assert\NotBlank()
	 */
	private $anniversaire;

	/**
	 * @ORM\ManyToMany(targetEntity="Kub\UserBundle\Entity\Tuteur", inversedBy="eleves", cascade={"all"})
	 * @Assert\Valid()
	 * @Assert\Count(max=2, maxMessage="L'élève ne peut avoir plus de deux tuteurs")
	 */
	private $tuteurs ;

	/**
	 * @ORM\ManyToOne(targetEntity="Kub\ClasseBundle\Entity\Niveau", inversedBy="eleves"))
	 */
	private $niveau ;

	/**
	 * @ORM\ManyToMany(targetEntity="Kub\ClasseBundle\Entity\Groupe", mappedBy="eleves")
	 */
	protected $groupes;

	/**
	 * @ORM\OneToOne(targetEntity="Kub\ArianeBundle\Entity\Fil", inversedBy="eleve", cascade={"persist", "remove"})
	 */
	private $fil ;

	/**
  	 * @ORM\OneToOne(targetEntity="Kub\UserBundle\Entity\Photo", cascade={"persist", "remove"})
   	 */
  	private $photo;

	public function initClass()
	{
		$this->class = "eleve";
	}

	public function __construct()
	{
		parent::__construct();

		$this->addRole("ROLE_ELEVE");
		$this->setfil(new \Kub\ArianeBundle\Entity\Fil) ;
		$this->tuteurs = new \Doctrine\Common\Collections\ArrayCollection;
		$this->groupes = new \Doctrine\Common\Collections\ArrayCollection;
	}

	/**
	 * @Assert\True(message="L'élève doit avoir un niveau")
	 */
	public function isNiveauHaving()
	{
		if($this->niveau != null)
		{
			return true ;
		}
		else
		{
			return false; 
		}
	}


}