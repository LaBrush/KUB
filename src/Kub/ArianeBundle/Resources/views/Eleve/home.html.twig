{% extends "::base.html.twig" %}

{% block body %}

	<div class="article">
			<h3 class="section-title">Fil d'Ariane</h3>
		</div>

	{% if is_granted('ROLE_ELEVE') %}
		<a href="{{ path('ariane_post_add') }}" class="button-yes new">Nouveau post</a>
	{% endif %}

	{% for post in liste_posts %}

		<article class="article-news bordered-espace-collaboratif">
			<div class="head-article">
				<h3 class="h2">{{ post.titre }}</h3>
				<span class="small bold">{{ post.dateAjout | date('d/m/Y')}}</span>
			</div>

			<div class="content-article">
				<p>
					{{ post.contenu }}
				</p>

				{% if is_granted("ROLE_ELEVE") %}
				<div class="buttons">
					<a class="button-espace-collaboratif" href="{{ path('ariane_post_edit', { 'id': post.id }) }}">Modifier</a>
				</div>
				{% endif %}
			</div>

			<div class="comments">
				<ul>
				{% for commentaire in post.commentaires %}
						<li class="commentaire">
							<span>
								<span class="auteur">{{ commentaire.auteur }} : </span>
								<span>{{ commentaire.contenu | capitalize }}</span>
								
								{% if app.user == commentaire.auteur %}
									{{ render(controller('KubArianeBundle:Commentaire:delete', { commentaire: commentaire.id })) }}
								{% endif %}
							</span>
						</li>
				{% endfor %}
				</ul>

				{{ render(controller('KubArianeBundle:Commentaire:add', { post: post.id })) }}
			</div>
		</article>

	{% endfor %}

{% endblock %}